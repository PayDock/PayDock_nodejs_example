<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        iframe {
            border: 0;
            width: 100%;
            height: 300px;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="https://app-sandbox.paydock.com/v1/widget.umd.js" ></script>
</head>
<body>
	<form id="paymentForm">

		$ <input type="text" id="amount" value="50"><br>

		<select id="currency">
			<option value="AUD">Australian Dollars</option>
			<option value="USD">American Dollars</option>
			<option value="GBP">British Pounds</option>
		</select>

		<input type="hidden" name="ps" id="ps" AUTOCOMPLETE="off"/>
		<input type="hidden" name="payment_type" id="payment_type" AUTOCOMPLETE="off"/>
		<input type="hidden" name="customer_id" id="customer_id" AUTOCOMPLETE="off"/>
		<input type="submit" value="Submit">

	</form> 

	<div id="widget"></div>

	<script>
		var widget = new paydock.HtmlWidget('#widget', 'b37753781812ce5dbf569029a748115506ba6219', '5968624efbe70f15089b4cda');
		widget.onFinishInsert('[name="ps"]', 'payment_source');
		widget.on('finish', function(){
			document.getElementByID('#payment_type').val("token")
		});
		widget.load();

		jQuery(document).submit(function(e){
			postData();
	        e.preventDefault();
		});

		function postData(){

		    var form = $('#paymentForm');

            var jsonData = {
            	'amount' : $('#amount').val(),
	            'currency' :  $('#currency').val(),
	            'token' :  $('#ps').val(),
	            'customer_id' :  $('#customer_id').val(),
	            'payment_type' :  $('#payment_type').val() 
	        };

	        jQuery.ajax({
	            method: "POST",
	            url: "/payment", 
	            contentType: "application/json",
	            data: JSON.stringify(jsonData)
	        });

		}
	</script>

</body>
</html>
